/*
 * hvac_ll_driver.c
 *
 *  Created on: Mar 8, 2024
 *      Author: jeffr
 */

#include "hvac_ll_driver.h"

/*Defines-----------------------------------------------*/


#if (PINX(CONTACT1)==0)
#define CONTACT1_IRQn		EXTI0_IRQn
#elif (PINX(CONTACT1)==1)
#define CONTACT1_IRQn		EXTI1_IRQn
#elif (PINX(CONTACT1)==2)
#define CONTACT1_IRQn		EXTI2_IRQn
#elif (PINX(CONTACT1)==3)
#define CONTACT1_IRQn		EXTI3_IRQn
#elif (PINX(CONTACT1)==4)
#define CONTACT1_IRQn		EXTI4_IRQn
#elif((PINX(CONTACT1)<10) && (PINX(CONTACT1)>4))
#define CONTACT1_IRQn		EXTI9_5_IRQn
#else
#define CONTACT1_IRQn		EXTI15_10_IRQn
#endif

/*Function definition ----------------------------------*/
void hvac_io_init(void){
	NVIC_EnableIRQ(CONTACT1_IRQn);

	/**
	 * SW1
	 */
	GPIOX_CLK_EN(SW1); GPIOX_CLK_EN(SW2);
	GPIOX_MODER(SW1, 0);
	GPIOX_MODER(SW2, 0);
	//GPIOX_PUPDR(SW1, 1);
	GPIOX_PUPDR(SW2, 1);
	/**
	 * Contactos
	 */
	GPIOX_CLK_EN(CONTACT1); GPIOX_CLK_EN(CONTACT2);
	GPIOX_MODER(CONTACT1, 0);
	GPIOX_MODER(CONTACT2, 0);
	GPIOX_PUPDR(CONTACT1, 2);
	GPIOX_PUPDR(CONTACT2, 2);
	/**
	 * Relay
	 */
	GPIOX_CLK_EN(RELAY1);GPIOX_CLK_EN(RELAY2);
	GPIOX_MODER(RELAY1, 0x1);
	GPIOX_MODER(RELAY2, 0x1);
	/**
	 * LCD
	 */
	GPIOX_CLK_EN(LCD_RS); GPIOX_CLK_EN(LCD_EN);
	GPIOX_CLK_EN(LCD_D4); GPIOX_CLK_EN(LCD_D5);
	GPIOX_CLK_EN(LCD_D6); GPIOX_CLK_EN(LCD_D7);

	GPIOX_MODER(LCD_RS, 0x1); GPIOX_MODER(LCD_EN, 1);
	GPIOX_MODER(LCD_D4, 0x1); GPIOX_MODER(LCD_D5, 1);
	GPIOX_MODER(LCD_D6, 0x1); GPIOX_MODER(LCD_D7, 1);
	/**
	 * STATUS
	 */
	GPIOX_CLK_EN(STATUS);
	GPIOX_MODER(STATUS, 1);
	/**
	 * Alarma de contacto
	 */
	GPIOX_CLK_EN(A_CONTACT);
	GPIOX_MODER(A_CONTACT, 1);

	return;
}
